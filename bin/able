#!/usr/bin/env ruby

require 'able'
require 'optparse'

project_options = {}

parser = OptionParser.new do |opts|
  opts.banner = "Usage: able [options] [targets]"

  opts.on "-C", "--src-dir path", "Change source directory" do |value|
    project_options[:src_root] = value
  end

  opts.on "-B", "--build-dir path", "Change build directory" do |value|
    project_options[:dst_root] = value
  end

  opts.on "-j", "--jobs count", "Change the number of threads" do |value|
    project_options[:threads] = value.to_i
  end
end

parser.parse!

project = Able::Project.new project_options

if ARGV and not ARGV.empty?
  ARGV.each do |target|
    project.build_target(target)
  end
else
  project.build_target
end

